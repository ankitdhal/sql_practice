CREATE DATABASE AD_DEMO;
USE AD_DEMO;

CREATE OR REPLACE TABLE AD_CONSUMER_COMPLAINTS
  (   DATE_RECEIVED STRING ,
      PRODUCT_NAME VARCHAR2(50) , 
	  SUB_PRODUCT  VARCHAR2(100) , 
	  ISSUE  VARCHAR2(100), 
      SUB_ISSUE  VARCHAR2(100),
      CONSUMER_COMPLAINT_NARRATIVE STRING,
      Company_Public_Response  STRING,
      Company VARCHAR(80),
      State_Name CHAR(40),
      Zip_Code STRING,
      Tags  VARCHAR(60),
      Consumer_Consent_Provided CHAR(20),
       Submitted_via STRING,
      Date_Sent_to_Company  STRING,
     Company_Response_to_Consumer VARCHAR(80),
     Timely_Response CHAR(40),
     CONSUMER_DISPUTED CHAR(40),
     COMPLAINT_ID  NUMBER(12,0) NOT NULL PRIMARY KEY
  ) ;
  
  SELECT * FROM AD_CONSUMER_COMPLAINTS;
  
  CREATE OR REPLACE TABLE CONSUMER_COMPLAINT_AWS LIKE AD_CONSUMER_COMPLAINTS; 
  SHOW COLUMNS IN CONSUMER_COMPLAINT_AWS;
  
  SELECT * FROM CONSUMER_COMPLAINT_AWS;
  
  LIST @AWS_CONSUMER_COMP;
  
  COPY INTO CONSUMER_COMPLAINT_AWS FROM @AWS_CONSUMER_COMP 
  FILE_FORMAT = (TYPE = CSV FIELD_DELIMITER = ',' SKIP_HEADER = 1)
  PURGE= TRUE;
  
  SELECT DISTINCT(CONSUMER_COMPLAINT_NARRATIVE) FROM CONSUMER_COMPLAINT_AWS;
